<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nyra AI | AI Consult</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: radial-gradient(circle at center, #0a0a0a 60%, #000);
      color: #f5d76e;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
    }

    header {
      width: 100%;
      padding: 25px 0;
      text-align: center;
      background: rgba(20, 20, 20, 0.8);
      box-shadow: 0 0 25px rgba(245, 215, 110, 0.3);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    header h1 {
      font-size: 2.4em;
      color: #f5d76e;
      letter-spacing: 2px;
    }
    
    .chat-container {
      width: 90%;
      max-width: 800px;
      margin: 40px auto;
      background: rgba(30, 30, 30, 0.8);
      border: 2px solid #333;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      display: flex;
      flex-direction: column;
      min-height: 70vh;
      max-height: 80vh;
      overflow: hidden;
    }
    
    /* --- AI Selection Tabs --- */
    .ai-tabs {
        display: flex;
        justify-content: center;
        background: #1a1a1a;
        padding: 10px 0;
        border-bottom: 2px solid #FFD700;
    }
    .ai-tab {
        background: #333;
        color: #fff;
        border: none;
        padding: 10px 20px;
        margin: 0 5px;
        cursor: pointer;
        border-radius: 5px;
        transition: background 0.3s;
    }
    .ai-tab.active {
        background: #FFD700;
        color: #000;
        font-weight: 700;
    }

    .chat-history {
      flex-grow: 1;
      padding: 20px;
      overflow-y: auto;
      scrollbar-width: none; 
      -ms-overflow-style: none;
    }

    .chat-history::-webkit-scrollbar {
      display: none; 
    }

    .message {
      padding: 10px 15px;
      margin-bottom: 15px;
      border-radius: 15px;
      max-width: 80%;
      font-size: 0.95em;
      line-height: 1.5;
    }

    .user-message {
      background-color: #f5d76e;
      color: #000;
      align-self: flex-end;
      margin-left: auto;
      border-bottom-right-radius: 5px;
    }

    .ai-message {
      background-color: #2c2c2c;
      color: #fff;
      border: 1px solid #FFD700;
      align-self: flex-start;
      margin-right: auto;
      border-bottom-left-radius: 5px;
    }
    
    .ai-message strong {
        color: #FFD700;
    }
    
    /* --- Recommendation Card Style --- */
    .recommendation-card {
        background: #3a3a3a;
        border: 1px solid #FFD700;
        padding: 15px;
        margin-top: 10px;
        border-radius: 8px;
        text-align: center;
    }
    .recommendation-card h4 {
        color: #FFD700;
        margin-top: 0;
        margin-bottom: 5px;
    }
    .recommendation-card p {
        color: #ccc;
        font-size: 0.9em;
        margin-bottom: 10px;
    }
    .recommendation-card button {
        background-color: #f5d76e;
        color: #000;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 600;
        transition: background-color 0.3s;
    }
    .recommendation-card button:hover {
        background-color: #E0C97F;
    }


    .chat-input-area {
      display: flex;
      padding: 15px;
      background: #1a1a1a;
      border-top: 2px solid #333;
    }

    .chat-input-area input {
      flex-grow: 1;
      padding: 12px;
      border: 1px solid #FFD700;
      border-radius: 8px;
      background: #000;
      color: #fff;
      font-size: 1em;
      margin-right: 10px;
    }
    
    .chat-input-area input:focus {
        outline: none;
        box-shadow: 0 0 5px #FFD700;
    }

    .chat-input-area button {
      padding: 12px 20px;
      background-color: #FFD700;
      color: #000;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s;
    }

    .chat-input-area button:hover {
      background-color: #E0C97F;
    }
    
    .back-btn {
      background-color: #333;
      color: #fff;
      border: 1px solid #FFD700;
      padding: 10px 20px;
      border-radius: 8px;
      margin-top: 20px;
      cursor: pointer;
    }

    footer {
      width: 100%;
      text-align: center;
      padding: 15px 0;
      background: rgba(0, 0, 0, 0.5);
      margin-top: auto;
      color: #aaa;
    }
  </style>
</head>
<body>
  <header>
    <h1>AI Consult</h1>
    <p style="color: #d6c269">Chat instantly with Nyra AI for health guidance.</p>
  </header>

  <div class="chat-container">
    <div class="ai-tabs">
        <button class="ai-tab active" id="humanTab" onclick="switchAI('human')">üë® Patient AI</button>
        <button class="ai-tab" id="petTab" onclick="switchAI('pet')">üêæ Pet AI</button>
    </div>
    
    <div class="chat-history" id="chatHistory">
      </div>
    <div class="chat-input-area">
      <input type="text" id="userInput" placeholder="Ask your question here...">
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>

  <button class="back-btn" onclick="window.location.href='home.html'">
    ‚Üê Back to Dashboard
  </button>

  <footer>¬© 2025 Nyra AI. Wellness in Every Dose.</footer>

  <script>
    const chatHistory = document.getElementById('chatHistory');
    const userInput = document.getElementById('userInput');
    let currentAI = 'human'; // Default to human AI

    // Global cart simulation (persists on this page)
    let cart = {}; 

    // Define recommendations
    const recommendations = {
        human: {
            name: "Paracetamol 500mg",
            description: "Recommended for common fever and mild aches.",
            price: "2.50"
        },
        pet: {
            name: "Pet Supplements",
            description: "Recommended for general wellness and energy support.",
            price: "320.00"
        }
    };

    // --- Core Chat Functions ---

    function addMessage(text, sender) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender}-message`;
      messageDiv.innerHTML = text;
      chatHistory.appendChild(messageDiv);
      chatHistory.scrollTop = chatHistory.scrollHeight;
    }
    
    function addRecommendation(item, type) {
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message ai-message';
        messageDiv.innerHTML = `
            Based on your query, I recommend this over-the-counter medicine:
            <div class="recommendation-card">
                <h4>${item.name} (‚Çπ${item.price})</h4>
                <p>${item.description}</p>
                <button onclick="addToCartFromAI('${item.name}', '${item.price}')">Add to Cart</button>
            </div>
        `;
        chatHistory.appendChild(messageDiv);
        chatHistory.scrollTop = chatHistory.scrollHeight;
    }
    
    function getAiResponse(userMessage, aiType) {
      const lowerCaseMsg = userMessage.toLowerCase();
      
      if (aiType === 'human') {
        if (lowerCaseMsg.includes('fever') || lowerCaseMsg.includes('headache') || lowerCaseMsg.includes('pain')) {
            addMessage(`I recommend taking a standard **Pain & Fever Reliever**. Remember to check the dosage.`, 'ai');
            addRecommendation(recommendations.human, 'human');
            return;
        } else if (lowerCaseMsg.includes('symptom') || lowerCaseMsg.includes('sick')) {
            return "I can offer general guidance, but for a **real diagnosis**, please use the Teleconsult feature to speak with a professional immediately.";
        } else {
            return "As your **Patient AI**, I can answer general health questions. For complex queries, please be specific or consider a human doctor.";
        }
      } else { // Pet AI
        if (lowerCaseMsg.includes('eat') || lowerCaseMsg.includes('food') || lowerCaseMsg.includes('energy')) {
            addMessage(`It sounds like your pet needs a **nutritional boost**. I recommend a general wellness supplement.`, 'ai');
            addRecommendation(recommendations.pet, 'pet');
            return;
        } else if (lowerCaseMsg.includes('vomit') || lowerCaseMsg.includes('limp') || lowerCaseMsg.includes('ill')) {
            return "For severe **pet symptoms**, please contact a veterinarian immediately. My advice is for minor well-being only.";
        } else {
            return "As your **Pet AI**, I provide advice on pet care, diet, and minor concerns. What specific pet issue are you asking about?";
        }
      }
    }

    // --- UI/Control Functions ---
    
    function switchAI(type) {
        currentAI = type;
        document.getElementById('humanTab').classList.remove('active');
        document.getElementById('petTab').classList.remove('active');
        document.getElementById(type + 'Tab').classList.add('active');
        
        chatHistory.innerHTML = ''; // Clear chat history
        const welcomeText = type === 'human' 
            ? "Hello! You are now chatting with **Patient AI**. Ask me about your symptoms or wellness."
            : "Hello! You are now chatting with **Pet AI**. Ask me about your pet's health, diet, or behavior.";
            
        addMessage(welcomeText, 'ai');
    }
    
    function sendMessage() {
      const userText = userInput.value.trim();
      
      if (userText === "") return;

      addMessage(userText, 'user');
      userInput.value = '';

      // 3. Simulate AI Typing/Delay
      const loadingMessage = document.createElement('div');
      loadingMessage.className = 'message ai-message';
      loadingMessage.innerHTML = 'Nyra AI is typing...';
      chatHistory.appendChild(loadingMessage);
      chatHistory.scrollTop = chatHistory.scrollHeight;

      // 4. Get and Display AI Response after a short delay
      setTimeout(() => {
        const response = getAiResponse(userText, currentAI);
        
        chatHistory.removeChild(loadingMessage); 
        
        if (response) {
             addMessage(response, 'ai');
        }
      }, 1500); // 1.5 second delay
    }

    // --- Cart Integration Logic ---
    
    // NOTE: This function simulates adding to the cart on the medicine.html page
    function addToCartFromAI(name, price) {
        // Use a prompt to simulate asking for the quantity (similar to buy option)
        const quantity = prompt(`How many units of ${name} do you want to add to your cart?`, 1);
        
        const count = parseInt(quantity);
        
        if (isNaN(count) || count <= 0) {
            alert("Invalid quantity. Medicine not added to cart.");
            return;
        }

        // Simulate the cart logic
        cart[name] = (cart[name] || 0) + count;

        // Display confirmation
        alert(`‚úÖ ${count} x ${name} added to your Cart! 
        
        You can find it on the Medicine page for checkout.`);
        
        // This is where you would normally update a persistent cart (like localStorage) 
        // and redirect the user to medicine.html if they click 'checkout'.
        // For this file-based demo, we just show a message.
        
        // Optional: Provide a next step
        const nextStep = document.createElement('div');
        nextStep.className = 'message ai-message';
        nextStep.innerHTML = `Your cart has been updated. Do you want to **<a href="medicine.html" style="color:#FFD700; font-weight:700;">Proceed to Medicine Page</a>** to confirm delivery details?`;
        chatHistory.appendChild(nextStep);
        chatHistory.scrollTop = chatHistory.scrollHeight;
    }


    // --- Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
        switchAI('human'); // Load initial welcome message
    });

    userInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

  </script>
</body>
</html>